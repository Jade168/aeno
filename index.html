<!DOCTYPE html>
<html lang="zh-HK">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
  <title>AENO V3 直屏卡通版</title>

  <link rel="manifest" href="./manifest.json" />
  <link rel="stylesheet" href="./style.css?v=3.0.0" />
</head>
<body>

  <div id="bootScreen">
    <div class="bootCard">
      <div class="logo">AENO</div>
      <div class="bootText">載入中…</div>
      <div class="bootHint">如卡住請刷新一次</div>
    </div>
  </div>

  <canvas id="gameCanvas"></canvas>

  <div id="uiRoot">

    <!-- 浮動助手 -->
    <div id="assistant">
      <div class="assistantAdFlag">AD</div>
      <div class="assistantFace">🐻</div>
      <div class="assistantName">AENO 熊仔助手</div>
      <button id="assistantTalkBtn">💬</button>
    </div>

    <!-- 對話框 -->
    <div id="chatBox" class="hidden">
      <div class="chatHeader">
        <div>助手對話</div>
        <button id="chatClose">✖</button>
      </div>
      <div id="chatLog"></div>
      <div class="chatInputRow">
        <input id="chatInput" placeholder="輸入指令：建造 / 升級 / 收集 / 巡邏 / 停止自動" />
        <button id="chatSend">送出</button>
      </div>
    </div>

    <!-- 主面板 -->
    <div id="mainPanel">
      <div id="panelHeader">
        <div class="panelTitle">📌 AENO 面板</div>
        <div class="panelBtns">
          <button id="panelMinBtn">—</button>
          <button id="panelHideBtn">▢</button>
        </div>
      </div>

      <div id="panelTabs">
        <button class="tabBtn active" data-tab="tabResources">資源</button>
        <button class="tabBtn" data-tab="tabBuild">建築</button>
        <button class="tabBtn" data-tab="tabMarket">交易所</button>
        <button class="tabBtn" data-tab="tabTech">科技樹</button>
        <button class="tabBtn" data-tab="tabAds">廣告/歌曲</button>
        <button class="tabBtn" data-tab="tabLog">系統</button>
      </div>

      <div id="panelBody">

        <!-- 資源 -->
        <div class="tabPage active" id="tabResources">
          <div class="grid2">
            <div class="statCard"><div class="k">金幣</div><div class="v" id="statGold">0</div></div>
            <div class="statCard"><div class="k">AENO</div><div class="v" id="statAeno">0</div></div>
            <div class="statCard"><div class="k">木材</div><div class="v" id="statWood">0</div></div>
            <div class="statCard"><div class="k">石頭</div><div class="v" id="statStone">0</div></div>
            <div class="statCard"><div class="k">鐵礦</div><div class="v" id="statIron">0</div></div>
            <div class="statCard"><div class="k">食物</div><div class="v" id="statFood">0</div></div>
          </div>

          <div class="grid2 mt8">
            <div class="statCard"><div class="k">人口</div><div class="v" id="statPop">0</div></div>
            <div class="statCard"><div class="k">領土</div><div class="v" id="statTerritory">0</div></div>
            <div class="statCard"><div class="k">文明度</div><div class="v" id="statCivil">0%</div></div>
            <div class="statCard"><div class="k">獸潮</div><div class="v" id="statBeast">未啟動</div></div>
          </div>

          <div class="btnRow mt10">
            <button id="btnExpand">🏞️ 擴大領土</button>
            <button id="btnZoomReset">🔍 重置縮放</button>
          </div>

          <div class="btnRow mt10">
            <button id="btnAutoOn">🤖 自動模式 ON</button>
            <button id="btnAutoOff">🛑 自動模式 OFF</button>
          </div>
        </div>

        <!-- 建築 -->
        <div class="tabPage" id="tabBuild">
          <div class="buildList">
            <button class="buildBtn" data-build="house">🏠 房屋</button>
            <button class="buildBtn" data-build="farm">🌾 農田</button>
            <button class="buildBtn" data-build="lumber">🪓 伐木場</button>
            <button class="buildBtn" data-build="quarry">⛏️ 石礦場</button>
            <button class="buildBtn" data-build="mine">⚒️ 鐵礦場</button>
            <button class="buildBtn" data-build="factory">🏭 工廠</button>
            <button class="buildBtn" data-build="wall">🧱 城牆</button>
            <button class="buildBtn" data-build="robot">🤖 機器人中心</button>
          </div>

          <div class="mt10">
            <div class="hint">
              📌 點上面按鈕會「排程建築」<br/>
              AI 助手會自動搵位置建造（唔會再話森林外）
            </div>
          </div>
        </div>

        <!-- 市場 -->
        <div class="tabPage" id="tabMarket">
          <div class="hint">交易所（簡化測試版）</div>
          <div class="marketRow">
            <select id="marketItem">
              <option value="wood">木材</option>
              <option value="stone">石頭</option>
              <option value="iron">鐵礦</option>
              <option value="food">食物</option>
            </select>
            <input id="marketQty" type="number" value="10" min="1" />
          </div>
          <div class="btnRow mt10">
            <button id="btnBuy">買入</button>
            <button id="btnSell">賣出</button>
          </div>
          <div class="hint mt10" id="marketPriceHint">價格會波動（每分鐘更新）</div>
        </div>

        <!-- 科技 -->
        <div class="tabPage" id="tabTech">
          <div class="hint">科技樹（簡化版）</div>
          <div class="techList">
            <button class="techBtn" data-tech="tools">🔧 工具學</button>
            <button class="techBtn" data-tech="agri">🌾 農業學</button>
            <button class="techBtn" data-tech="mining">⛏️ 採礦學</button>
            <button class="techBtn" data-tech="robotics">🤖 機械學</button>
            <button class="techBtn" data-tech="economy">📈 經濟學</button>
          </div>
        </div>

        <!-- Ads -->
        <div class="tabPage" id="tabAds">
          <div class="hint">
            📌 廣告位設計（正式版會由廣告商上傳音樂/歌曲）<br/>
            目前用測試音樂模擬「看廣告/聽歌」。
          </div>

          <div class="btnRow mt10">
            <button id="btnPlayAd">▶ 播放廣告歌曲</button>
            <button id="btnStopAd">⏹ 停止</button>
          </div>

          <div class="hint mt10">
            🎵 聽歌越耐，AENO 增長越快（算法已隱藏）
          </div>

          <div class="hint mt10">
            🏷️ 機器人貼紙位（Ad Slot）已預留<br/>
            🏳️ 助手頭頂旗幟位（Ad Slot）已預留
          </div>
        </div>

        <!-- Log -->
        <div class="tabPage" id="tabLog">
          <div class="btnRow">
            <button id="btnSaveNow">💾 即時保存</button>
            <button id="btnReset">⚠ 清除存檔</button>
          </div>
          <div id="sysLog"></div>
        </div>

      </div>
    </div>

    <!-- Panel minimized button -->
    <button id="panelRestoreBtn" class="hidden">📌 面板</button>

  </div>

  <audio id="adAudio" preload="auto"></audio>

  <script src="./game.js?v=3.0.0"></script>
</body>
</html>
