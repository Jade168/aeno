<!DOCTYPE html>
<html lang="zh-HK">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <title>AENO V3</title>

  <link rel="manifest" href="manifest.json">
  <link rel="stylesheet" href="style.css" />

</head>

<body>

  <canvas id="game"></canvas>

  <!-- BOOT SCREEN (Login/Register) -->
  <div id="bootScreen">
    <div class="bootCard">
      <div class="logo">AENO</div>
      <div class="bootText">V3 卡通直屏版</div>
      <div class="bootHint">
        註冊後永久保存進度（離線可玩）<br>
        AENO 挖礦方式：學外語發音 + 注意力成本
      </div>

      <div style="margin-top:12px;text-align:left;font-weight:900;font-size:13px;">
        玩家帳號：
      </div>

      <input id="bootUser" placeholder="輸入用戶名 (例如: peter168)"
        style="width:100%;margin-top:6px;padding:10px;border-radius:14px;border:2px solid #bfe6ff;outline:none;font-weight:800;" />

      <input id="bootPass" placeholder="輸入密碼"
        type="password"
        style="width:100%;margin-top:8px;padding:10px;border-radius:14px;border:2px solid #bfe6ff;outline:none;font-weight:800;" />

      <div style="margin-top:12px;display:flex;gap:8px;">
        <button id="btnRegister"
          style="flex:1;border:none;border-radius:16px;padding:12px;background:#22c55e;color:white;font-weight:900;cursor:pointer;">
          註冊
        </button>

        <button id="btnLogin"
          style="flex:1;border:none;border-radius:16px;padding:12px;background:#38bdf8;color:white;font-weight:900;cursor:pointer;">
          登入
        </button>
      </div>

      <div id="bootMsg" style="margin-top:10px;font-size:12px;font-weight:900;color:#ef4444;"></div>

      <div style="margin-top:12px;font-size:11px;opacity:.75;line-height:1.4;">
        ⚠️ 注意：暫時為離線帳號（Local Save），未來可接 Firebase / 金鑰系統。
      </div>
    </div>
  </div>


  <!-- UI ROOT -->
  <div id="uiRoot">

    <!-- HUD TOP -->
    <div id="hudTop">
      <div class="hudBox" id="hudLeft">
        <div class="hudRow">
          <span class="pill">🌍 <span id="planetName">?</span></span>
          <span class="pill">⏱️ <span id="gameYear">0</span> 年</span>
          <span class="pill">👥 <span id="popCount">0</span></span>
        </div>
        <div class="hudRow" style="margin-top:4px;">
          <span class="pill">🪙 金幣: <span id="coins">0</span></span>
          <span class="pill">🟡 AENO: <span id="aeno">0.0000</span></span>
        </div>
      </div>

      <div class="hudBox" id="hudRight">
        <div class="hudRow">
          <span class="pill">🪵 木: <span id="wood">0</span></span>
          <span class="pill">🪨 石: <span id="stone">0</span></span>
          <span class="pill">⛏️ 鐵: <span id="iron">0</span></span>
          <span class="pill">🌾 糧: <span id="food">0</span></span>
        </div>
        <div class="hudRow" style="margin-top:4px;">
          <span class="pill">🏠 房屋: <span id="houseCount">0</span></span>
          <span class="pill">⚙️ 工廠: <span id="factoryCount">0</span></span>
          <span class="pill">🤖 機器人: <span id="robotCount">0</span></span>
        </div>
      </div>
    </div>

    <!-- MAIN PANEL -->
    <button id="togglePanelBtn">📌 面板</button>

    <div id="panel" class="hidden">
      <div id="panelHeader">
        <span>📌 控制中心</span>
        <span>
          <button id="btnSave">保存</button>
          <button id="btnHidePanel">收起</button>
        </span>
      </div>

      <div id="panelBody">

        <div class="muted">
          提示：點領土空地可建築。<br>
          地圖：拖動 / 縮放 / 點選建築升級。
        </div>

        <div class="btnRow">
          <button id="btnBuildMode">🏗️ 建築</button>
          <button id="btnUpgradeMode">⬆️ 升級</button>
          <button id="btnAuto">🤖 自動: <span id="autoState">ON</span></button>
        </div>

        <div class="btnRow">
          <button id="btnAdSong">🎵 廣告歌</button>
          <button id="btnLoopSong">🔁 Loop: <span id="loopState">ON</span></button>
        </div>

        <div class="btnRow">
          <button id="btnPronounce">🗣️ 發音挖礦</button>
          <button id="btnRobotSend">🚀 派機器人</button>
          <button id="btnExchange">🏦 交易所</button>
        </div>

        <div class="btnRow">
          <button id="btnTech">🧬 科技樹</button>
          <button id="btnPlanetInfo">🪐 星球</button>
          <button id="btnLogout">🚪 登出</button>
        </div>

        <div style="margin-top:10px;">
          <b>AI助手建築優先：</b>
          <div class="btnRow" style="flex-wrap:wrap;">
            <button class="prioBtn" data-prio="house">🏠 房屋</button>
            <button class="prioBtn" data-prio="lumber">🪵 伐木</button>
            <button class="prioBtn" data-prio="farm">🌾 農田</button>
          </div>
          <div class="btnRow" style="flex-wrap:wrap;">
            <button class="prioBtn" data-prio="mine">⛏️ 礦場</button>
            <button class="prioBtn" data-prio="factory">⚙️ 工廠</button>
            <button class="prioBtn" data-prio="wall">🏰 城牆</button>
          </div>
        </div>

        <div id="sysLog"></div>

      </div>
    </div>

    <!-- ASSISTANT -->
    <div id="assistant">
      <div class="assistantBody">
        <div class="assistantAdFlag">AD</div>
        <div class="assistantFace" id="assistantFace">🐺</div>
        <div class="assistantName" id="assistantName">LUPUS</div>
        <div class="assistantShirt">AD SLOT</div>
      </div>
      <button id="assistantTalkBtn">💬 對話</button>
    </div>

    <!-- CHAT BOX -->
    <div id="chatBox" class="hidden">
      <div class="chatHeader">
        <span>🐾 AI助手</span>
        <button id="chatClose">X</button>
      </div>

      <div id="chatLog"></div>

      <div class="chatInputRow">
        <input id="chatInput" placeholder="輸入指令：巡邏 / 收集 / 建造 / 升級..." />
        <button id="chatSend">送出</button>
      </div>
    </div>

  </div>

  <script src="characters.js"></script>
  <script src="game.js"></script>

  <script>
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("./sw.js");
    }
  </script>
<script src="ai-assistant.js"></script>

</body>
</html>
